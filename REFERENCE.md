# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

* [`cups`](#cups): Installs, configures, and manages the CUPS service.
* [`cups::packages`](#cups--packages): Handles the installation of all required CUPS packages
* [`cups::params`](#cups--params): Manages all OS dependent values.
* [`cups::queues`](#cups--queues): Encapsulates all private classes handling CUPS queues.
* [`cups::queues::default`](#cups--queues--default): Manages the default destination of the CUPS server.
* [`cups::queues::resources`](#cups--queues--resources): Creates cups_queue resources from hashes.
* [`cups::queues::unmanaged`](#cups--queues--unmanaged): A convenience wrapper around the `resources` metatype.
* [`cups::server`](#cups--server): Encapsulates all private classes managing the CUPS server.
* [`cups::server::config`](#cups--server--config): Encapsulates all configuration of the CUPS server
* [`cups::server::services`](#cups--server--services): Installs and manages all required CUPS services
* [`cups::workarounds::systemd_service_restart`](#cups--workarounds--systemd_service_restart): Adds a ListenStream dependency to the CUPS socket systemd unit

### Resource types

* [`cups_queue`](#cups_queue): Installs and manages CUPS queues.  Printers: Minimal manifest examples      cups_queue { 'MinimalRaw':       ensure => 'printer',       uri  

## Classes

### <a name="cups"></a>`cups`

All resources in this module require the CUPS daemon to be installed and configured in a certain way.
To ensure these preconditions you should include the main `cups` class wherever you use this module.

* **Since** 0.0.1

#### Examples

##### Install and run the CUPS server using default values

```puppet
include '::cups'
```

##### Additionally set the default printer

```puppet
class { '::cups':
  default_queue => 'Office'
}
```

##### Install HP PPD files before managing any printer queue

```puppet
package { 'hplip':
  ensure => present
}

class { '::cups':
  require => Package['hplip']
}
```

#### Parameters

The following parameters are available in the `cups` class:

* [`access_log_level`](#-cups--access_log_level)
* [`browse_dnssd_subtypes`](#-cups--browse_dnssd_subtypes)
* [`browse_local_protocols`](#-cups--browse_local_protocols)
* [`browse_web_if`](#-cups--browse_web_if)
* [`browsing`](#-cups--browsing)
* [`default_queue`](#-cups--default_queue)
* [`listen`](#-cups--listen)
* [`location`](#-cups--location)
* [`log_debug_history`](#-cups--log_debug_history)
* [`log_level`](#-cups--log_level)
* [`log_time_format`](#-cups--log_time_format)
* [`max_clients`](#-cups--max_clients)
* [`max_clients_per_host`](#-cups--max_clients_per_host)
* [`max_log_size`](#-cups--max_log_size)
* [`max_request_size`](#-cups--max_request_size)
* [`package_ensure`](#-cups--package_ensure)
* [`package_manage`](#-cups--package_manage)
* [`package_names`](#-cups--package_names)
* [`page_log_format`](#-cups--page_log_format)
* [`papersize`](#-cups--papersize)
* [`purge_unmanaged_queues`](#-cups--purge_unmanaged_queues)
* [`resources`](#-cups--resources)
* [`server_alias`](#-cups--server_alias)
* [`server_name`](#-cups--server_name)
* [`service_enable`](#-cups--service_enable)
* [`service_ensure`](#-cups--service_ensure)
* [`service_manage`](#-cups--service_manage)
* [`service_names`](#-cups--service_names)
* [`web_interface`](#-cups--web_interface)
* [`max_hold_time`](#-cups--max_hold_time)
* [`max_job_time`](#-cups--max_job_time)
* [`max_jobs`](#-cups--max_jobs)
* [`max_jobs_per_printer`](#-cups--max_jobs_per_printer)
* [`max_copies`](#-cups--max_copies)
* [`max_jobs_per_user`](#-cups--max_jobs_per_user)

##### <a name="-cups--access_log_level"></a>`access_log_level`

Data type: `Optional[String]`

Sets the `AccessLogLevel` directive of the CUPS server.

Default value: `undef`

##### <a name="-cups--browse_dnssd_subtypes"></a>`browse_dnssd_subtypes`

Data type: `Optional[Variant[String, Array[String]]]`

Sets the `BrowseDNSSDSubTypes` directive of the CUPS server.
Accepts a string or an array of supported subtypes without leading underscore, e.g. `['cups', 'print']`.

Default value: `undef`

##### <a name="-cups--browse_local_protocols"></a>`browse_local_protocols`

Data type: `Optional[Variant[String, Array[String]]]`

Sets the `BrowseLocalProtocols` directive of the CUPS server.
Accepts a string or an array of supported protocols.

Default value: `undef`

##### <a name="-cups--browse_web_if"></a>`browse_web_if`

Data type: `Optional[Boolean]`

Boolean value for the `BrowseWebIF` directive of the CUPS server.

Default value: `undef`

##### <a name="-cups--browsing"></a>`browsing`

Data type: `Boolean`

Boolean value for the `Browsing` directive of the CUPS server.

Default value: `false`

##### <a name="-cups--default_queue"></a>`default_queue`

Data type: `Optional[String]`

The name of the default destination for all print jobs.
Requires the catalog to contain a `cups_queue` resource with the same name.

Default value: `undef`

##### <a name="-cups--listen"></a>`listen`

Data type: `Variant[String, Array[String]]`

Which addresses to the CUPS daemon should listen to.
Accepts (an array of) strings.
Note that the `cupsd.conf` directive `Port 631` is equivalent to `Listen *:631`.
*Warning*: For this module to work, it is *mandatory* that CUPS is listening on `localhost:631`.

Default value: `['localhost:631', '/var/run/cups/cups.sock']`

##### <a name="-cups--location"></a>`location`

Data type: `Optional[Variant[String, Hash]]`

Sets the access control lists for the CUPS web interface. Restricts access to localhost by default.

Default value: `undef`

##### <a name="-cups--log_debug_history"></a>`log_debug_history`

Data type: `Optional[Integer]`

Sets the `LogDebugHistory` directive of the CUPS server.

Default value: `undef`

##### <a name="-cups--log_level"></a>`log_level`

Data type: `Optional[String]`

Sets the `LogLevel` directive of the CUPS server.

Default value: `undef`

##### <a name="-cups--log_time_format"></a>`log_time_format`

Data type: `Optional[String]`

Sets the `LogTimeFormat` directive of the CUPS server.

Default value: `undef`

##### <a name="-cups--max_clients"></a>`max_clients`

Data type: `Optional[Integer]`

Specifies the maximum number of simultaneous clients to support.

Default value: `undef`

##### <a name="-cups--max_clients_per_host"></a>`max_clients_per_host`

Data type: `Optional[Integer]`

Specifies the maximum number of simultaneous clients to support from a single address.

Default value: `undef`

##### <a name="-cups--max_log_size"></a>`max_log_size`

Data type: `Optional[Variant[Integer, String]]`

Sets the `MaxLogSize` directive of the CUPS server.

Default value: `undef`

##### <a name="-cups--max_request_size"></a>`max_request_size`

Data type: `Optional[Integer]`

Specifies the maximum request/file size in bytes.

Default value: `undef`

##### <a name="-cups--package_ensure"></a>`package_ensure`

Data type: `String`

Whether CUPS packages should be `present` or `absent`.

Default value: `'present'`

##### <a name="-cups--package_manage"></a>`package_manage`

Data type: `Boolean`

Whether to manage package installation at all.

Default value: `true`

##### <a name="-cups--package_names"></a>`package_names`

Data type: `Variant[String, Array[String]]`

A name or an array of names of all packages needed to be installed
in order to run CUPS and provide `ipptool`. OS dependent defaults apply.

Default value: `$cups::params::package_names`

##### <a name="-cups--page_log_format"></a>`page_log_format`

Data type: `Optional[String]`

Sets the `PageLogFormat` directive of the CUPS server.

Default value: `undef`

##### <a name="-cups--papersize"></a>`papersize`

Data type: `Optional[String]`

Sets the system's default `/etc/papersize`. See `man papersize` for supported values.

Default value: `undef`

##### <a name="-cups--purge_unmanaged_queues"></a>`purge_unmanaged_queues`

Data type: `Boolean`

Setting `true` will remove all queues from the node
which do not match a `cups_queue` resource in the current catalog.

Default value: `false`

##### <a name="-cups--resources"></a>`resources`

Data type: `Optional[Hash]`

This attribute is intended for use with Hiera or any other ENC.

Default value: `undef`

##### <a name="-cups--server_alias"></a>`server_alias`

Data type: `Optional[Variant[String, Array[String]]]`

Sets the `ServerAlias` directive of the CUPS server.

Default value: `undef`

##### <a name="-cups--server_name"></a>`server_name`

Data type: `Optional[String]`

Sets the `ServerName` directive of the CUPS server.

Default value: `undef`

##### <a name="-cups--service_enable"></a>`service_enable`

Data type: `Boolean`

Whether the CUPS services should be enabled to run at boot.

Default value: `true`

##### <a name="-cups--service_ensure"></a>`service_ensure`

Data type: `String`

Whether the CUPS services should be `running` or `stopped`.

Default value: `'running'`

##### <a name="-cups--service_manage"></a>`service_manage`

Data type: `Boolean`

Whether to manage services at all.

Default value: `true`

##### <a name="-cups--service_names"></a>`service_names`

Data type: `Variant[String, Array[String]]`

A name or an array of names of all CUPS services to be managed.

Default value: `'cups'`

##### <a name="-cups--web_interface"></a>`web_interface`

Data type: `Optional[Boolean]`

Boolean value to enable or disable the server's web interface.

Default value: `undef`

##### <a name="-cups--max_hold_time"></a>`max_hold_time`

Data type: `Optional[Integer]`

Specifies the maximum time a job may remain in the "indefinite" hold state before it is canceled.

Default value: `undef`

##### <a name="-cups--max_job_time"></a>`max_job_time`

Data type: `Optional[Integer]`

Specifies the maximum time a job may take to print before it is canceled.

Default value: `undef`

##### <a name="-cups--max_jobs"></a>`max_jobs`

Data type: `Optional[Integer]`

Specifies the maximum number of simultaneous jobs that are allowed.

Default value: `undef`

##### <a name="-cups--max_jobs_per_printer"></a>`max_jobs_per_printer`

Data type: `Optional[Integer]`

Specifies the maximum number of simultaneous jobs that are allowed per printer.

Default value: `undef`

##### <a name="-cups--max_copies"></a>`max_copies`

Data type: `Optional[Integer]`

Specifies the maximum number of copies that a user can print of each job.

Default value: `undef`

##### <a name="-cups--max_jobs_per_user"></a>`max_jobs_per_user`

Data type: `Optional[Integer]`

Specifies the maximum number of simultaneous jobs that are allowed per user.

Default value: `undef`

### <a name="cups--packages"></a>`cups::packages`

Private class

This class is a convenience wrapper around a `package` resource.
It inherits the `package_*` attributes from the public {cups} class
and by default ensures their presence.

* **Since** 2.0.0

#### Examples

##### This class is implicitly declared through

```puppet
class { '::cups':
  package_names => ['cups', 'ipptool']
}
```

### <a name="cups--params"></a>`cups::params`

Private class

The name of the `cups` and `ipptool` packages for all supported
operating systems are stored here and determined through facts.

* **Since** 1.0.0

### <a name="cups--queues"></a>`cups::queues`

Private class

This class encapsulates the indirect handling of CUPS queues
and serves as a common container for dependecy relationships.

* **Since** 2.0.0

### <a name="cups--queues--default"></a>`cups::queues::default`

Private class

This class inherits the name of the desired `default_queue` from the public {cups} class.
A corresponding {puppet_types::cups_queue} resource is required in the same catalog,
or catalog compliation will fail.

* **Since** 2.0.0

#### Examples

##### This class is implicitly declared through

```puppet
class { '::cups':
  default_queue => 'Office'
}
```

### <a name="cups--queues--resources"></a>`cups::queues::resources`

Private class

This class is a convenience wrapper around the `create_resources` function.
It inherits the `resources` attribute from the public {cups} class
and enables Hiera or any other ENC to create {puppet_types::cups_queue} resources.

* **Since** 2.0.0

#### Examples

##### This class is implicitly used when providing Hiera data like

```puppet
cups::resources:
  Warehouse:
    ensure: printer
    model: drv:///sample.drv/generic.ppd
    uri: socket://warehouse.initech.com
```

### <a name="cups--queues--unmanaged"></a>`cups::queues::unmanaged`

Private class

This class inherits the `purge_unmanaged_queues` attribute from the public {cups} class.
If set to `true` all CUPS queues not managed in the current Puppet catalog will be deleted.

* **Since** 2.0.0

#### Examples

##### This class is implicitly declared through

```puppet
class { '::cups':
  purge_unmanaged_queues => true
}
```

### <a name="cups--server"></a>`cups::server`

Private class

This class encapsulates the management of the CUPS server and its configuration files,
and serves as a common container for dependecy relationships.

* **Since** 2.0.0

### <a name="cups--server--config"></a>`cups::server::config`

Private class

This class inherits the several attributes from the public {cups} class.

* **Since** 2.0.0

#### Examples

##### This class is implicitly declared e.g. through

```puppet
class { '::cups':
  listen        => 'localhost:631',
  papersize     => 'A4',
  web_interface => true
}
```

### <a name="cups--server--services"></a>`cups::server::services`

Private class

This class is a convenience wrapper around a `service` resource.
It inherits the `service_*` attributes from the public {cups} class
and by default ensures their presence.

* **Since** 2.0.0

#### Examples

##### This class is implicitly declared through

```puppet
class { '::cups':
  service_names => 'cups'
}
```

### <a name="cups--workarounds--systemd_service_restart"></a>`cups::workarounds::systemd_service_restart`

On some systemd based Linux distributions the Puppet run fails because
during service restart systemd would prematurely yield back control to
Puppet which would then fail to install print queues.

This class makes the configured systemd unit for CUPS to listen on port 631
before control is yielded back to Puppet thereby preventing the failure.

* **Since** 2.1.1

* **See also**
  * https://bugzilla.redhat.com/show_bug.cgi?id=1088918

#### Examples

##### The default inclusion

```puppet
include '::cups::workarounds::systemd_service_restart'
```

##### Adding the ListenStream to a different unit

```puppet
class { '::cups::workarounds::systemd_service_restart':
  unit => 'mycups.socket'
}
```

#### Parameters

The following parameters are available in the `cups::workarounds::systemd_service_restart` class:

* [`unit`](#-cups--workarounds--systemd_service_restart--unit)

##### <a name="-cups--workarounds--systemd_service_restart--unit"></a>`unit`

Data type: `String`

The name of the systemd unit which should wait for CUPS to listen on port 631

Default value: `'cups.socket'`

## Resource types

### <a name="cups_queue"></a>`cups_queue`

Installs and manages CUPS queues.

Printers: Minimal manifest examples

    cups_queue { 'MinimalRaw':
      ensure => 'printer',
      uri    => 'lpd://192.168.2.105/binary_p1'
    }

  OR

    cups_queue { 'MinimalModel':
      ensure => 'printer',
      model  => 'drv:///sample.drv/generic.ppd',
      uri    => 'lpd://192.168.2.105/binary_p1'
    }

    The command `lpinfo -m` lists all models available on the node.

  OR

    cups_queue { 'MinimalPPD':
      ensure => 'printer',
      ppd    => '/usr/share/cups/model/myprinter.ppd',
      uri    => 'lpd://192.168.2.105/binary_p1'
    }

Classes: Providing only the mandatory attributes

    cups_queue { 'MinimalClass':
      ensure  => 'class',
      members => ['Office', 'Warehouse']
    }

Note that configurable options of a class are those of its first member.

#### Properties

The following properties are available in the `cups_queue` type.

##### `accepting`

Valid values: `true`, `false`

Boolean value specifying whether the queue should accept print jobs or reject them.

##### `access`

Manages queue access control. Takes a hash with keys `policy` and `users`.
The `allow` policy restricts access to the `users` provided,
while the `deny` policy lets everybody except the specified `users` submit jobs.
The `users` are provided as a non-empty array of Unix group names (prefixed with an `@`) and Unix user names.

##### `description`

A short informative description of the queue.

##### `enabled`

Valid values: `true`, `false`

Boolean value specifying whether the queue should be running or stopped.

##### `ensure`

Valid values: `class`, `printer`, `absent`

(mandatory) Specifies whether this queue should be a `class`, a `printer` or `absent`.

##### `held`

Valid values: `true`, `false`

A held queue will print all jobs in print or pending, but all new jobs will be held. Setting `false` will release them.

##### `location`

A short information where to find the hardcopies.

##### `make_and_model`

(printer-only) This value is used for driver updates and changes.
Matches the `NickName` (fallback `ModelName`) value from the printer's PPD file
if the printer was installed using a PPD file or a model,
and `Local System V Printer` or `Local Raw Printer` otherwise.

##### `members`

(class-only, mandatory) A non-empty array with the names of CUPS queues.
The class will be synced to contain only these members in the given order.
If the catalog contains `cups_queue` resources for these queues, they will be required automatically.

##### `options`

A hash of options (as keys) and their target value. Almost every option you can set with
`lpadmin -p [queue_name] -o key=value` is supported here. Use `puppet resource cups_queue [queue_name]`
on the node for a list of all supported options for the given queue, and `lpoptions -p [queue_name] -l`
to see a list of available values for the most commonly used printer specific options.

##### `shared`

Valid values: `true`, `false`

Boolean value specifying whether to share this queue on the network.

##### `uri`

(printer-only) The device URI of the printer. Use `lpinfo -v` on the node to scan for printer URIs.

#### Parameters

The following parameters are available in the `cups_queue` type.

* [`model`](#-cups_queue--model)
* [`name`](#-cups_queue--name)
* [`ppd`](#-cups_queue--ppd)
* [`provider`](#-cups_queue--provider)

##### <a name="-cups_queue--model"></a>`model`

(printer-only) A supported printer model. Use `lpinfo -m` on the node to list all models available.

##### <a name="-cups_queue--name"></a>`name`

namevar

(mandatory) Queue names may contain any printable character except SPACES, TABS, (BACK)SLASHES, QUOTES, COMMAS or "#".

##### <a name="-cups_queue--ppd"></a>`ppd`

(printer-only) The absolute path to a PPD file on the node.
If the catalog contains a `file` resource with this path as title, it will automatically be required.
The recommended location for your PPD files is `/usr/share/cups/model/` or `/usr/local/share/cups/model/`.

##### <a name="-cups_queue--provider"></a>`provider`

The specific backend to use for this `cups_queue` resource. You will seldom need to specify this --- Puppet will usually
discover the appropriate provider for your platform.

